<template>
  <div class="cont">
    <div class="box">
        <div class="pic">
            <img
                class="lazy"
                width="500" height="200"
                src="https://preview.qiantucdn.com/weitu/79/12/80/43Z58PICGe3yQDKVMapgj_PIC2018.jpg!kuan320"
                data-src="https://preview.qiantucdn.com/weitu/79/12/80/43Z58PICGe3yQDKVMapgj_PIC2018.jpg!kuan320" alt="">
        </div>
    </div>
    <div class="box">
        <div class="pic">
            <img
                class="lazy"
                width="500" height="500"
                src="https://preview.qiantucdn.com/weitu/79/12/80/43Z58PICGe3yQDKVMapgj_PIC2018.jpg!kuan320"
                data-src="https://preview.qiantucdn.com/weitu/82/60/34/59458PICvTPMGbBX9U3py_PIC2018.jpg!kuan320" alt="">
        </div>
    </div>
    <div class="box">
        <div class="pic">
            <img
                class="lazy"
                width="500" height="600"
                src="https://preview.qiantucdn.com/weitu/79/12/80/43Z58PICGe3yQDKVMapgj_PIC2018.jpg!kuan320"
                data-src="https://preview.qiantucdn.com/weitu/52/74/06/91r58PICdHZiGe6EcTiNY_PIC2018.jpg!kuan320" alt="">
        </div>
    </div>
    <div class="box">
        <div class="pic">
            <img
                class="lazy"
                width="500" height="300"
                src="https://preview.qiantucdn.com/weitu/79/12/80/43Z58PICGe3yQDKVMapgj_PIC2018.jpg!kuan320"
                data-src="https://preview.qiantucdn.com/weitu/82/60/34/59458PICvTPMGbBX9U3py_PIC2018.jpg!kuan320" alt="">
        </div>
    </div>
    <div class="box">
        <div class="pic">
            <img
                class="lazy"
                width="500" height="200"
                src="https://preview.qiantucdn.com/weitu/79/12/80/43Z58PICGe3yQDKVMapgj_PIC2018.jpg!kuan320"
                data-src="https://preview.qiantucdn.com/weitu/52/74/06/91r58PICdHZiGe6EcTiNY_PIC2018.jpg!kuan320" alt="">
        </div>
    </div>
    <div class="box">
        <div class="pic">
            <img
                class="lazy"
                width="500" height="300"
                src="https://preview.qiantucdn.com/weitu/79/12/80/43Z58PICGe3yQDKVMapgj_PIC2018.jpg!kuan320"
                data-src="https://preview.qiantucdn.com/weitu/82/60/34/59458PICvTPMGbBX9U3py_PIC2018.jpg!kuan320" alt="">
        </div>
    </div>
    <div class="box">
        <div class="pic">
            <img
                class="lazy"
                width="500" height="200"
                src="https://preview.qiantucdn.com/weitu/79/12/80/43Z58PICGe3yQDKVMapgj_PIC2018.jpg!kuan320"
                data-src="https://preview.qiantucdn.com/weitu/52/74/06/91r58PICdHZiGe6EcTiNY_PIC2018.jpg!kuan320" alt="">
        </div>
    </div>
    <div class="box">
        <div class="pic">
            <img
                class="lazy"
                width="500" height="300"
                src="https://preview.qiantucdn.com/weitu/79/12/80/43Z58PICGe3yQDKVMapgj_PIC2018.jpg!kuan320"
                data-src="https://preview.qiantucdn.com/weitu/82/60/34/59458PICvTPMGbBX9U3py_PIC2018.jpg!kuan320" alt="">
        </div>
    </div>
    <div class="box">
        <div class="pic">
            <img
                class="lazy"
                width="500" height="200"
                src="https://preview.qiantucdn.com/weitu/79/12/80/43Z58PICGe3yQDKVMapgj_PIC2018.jpg!kuan320"
                data-src="https://preview.qiantucdn.com/weitu/52/74/06/91r58PICdHZiGe6EcTiNY_PIC2018.jpg!kuan320" alt="">
        </div>
    </div>
    <div class="box">
        <div class="pic">
            <img
                class="lazy"
                width="500" height="200"
                src="https://preview.qiantucdn.com/weitu/79/12/80/43Z58PICGe3yQDKVMapgj_PIC2018.jpg!kuan320"
                data-src="https://preview.qiantucdn.com/weitu/52/74/06/91r58PICdHZiGe6EcTiNY_PIC2018.jpg!kuan320" alt="">
        </div>
    </div>
    <div class="box">
        <div class="pic">
            <img
                class="lazy"
                width="500" height="300"
                src="https://preview.qiantucdn.com/weitu/79/12/80/43Z58PICGe3yQDKVMapgj_PIC2018.jpg!kuan320"
                data-src="https://preview.qiantucdn.com/weitu/82/60/34/59458PICvTPMGbBX9U3py_PIC2018.jpg!kuan320" alt="">
        </div>
    </div>
    <div class="box">
        <div class="pic">
            <img
                class="lazy"
                width="500" height="200"
                src="https://preview.qiantucdn.com/weitu/79/12/80/43Z58PICGe3yQDKVMapgj_PIC2018.jpg!kuan320"
                data-src="https://preview.qiantucdn.com/weitu/52/74/06/91r58PICdHZiGe6EcTiNY_PIC2018.jpg!kuan320" alt="">
        </div>
    </div>
    <div class="box">
        <div class="pic">
            <img
                class="lazy"
                width="500" height="200"
                src="https://preview.qiantucdn.com/weitu/79/12/80/43Z58PICGe3yQDKVMapgj_PIC2018.jpg!kuan320"
                data-src="https://preview.qiantucdn.com/weitu/52/74/06/91r58PICdHZiGe6EcTiNY_PIC2018.jpg!kuan320" alt="">
        </div>
    </div>
    <div class="box">
        <div class="pic">
            <img
                class="lazy"
                width="500" height="200"
                src="https://preview.qiantucdn.com/weitu/79/12/80/43Z58PICGe3yQDKVMapgj_PIC2018.jpg!kuan320"
                data-src="https://preview.qiantucdn.com/weitu/79/12/80/43Z58PICGe3yQDKVMapgj_PIC2018.jpg!kuan320" alt="">
        </div>
    </div>
    <div class="box">
        <div class="pic">
            <img
                class="lazy"
                width="500" height="500"
                src="https://preview.qiantucdn.com/weitu/79/12/80/43Z58PICGe3yQDKVMapgj_PIC2018.jpg!kuan320"
                data-src="https://preview.qiantucdn.com/weitu/82/60/34/59458PICvTPMGbBX9U3py_PIC2018.jpg!kuan320" alt="">
        </div>
    </div>
    <div class="box">
        <div class="pic">
            <img
                class="lazy"
                width="500" height="600"
                src="https://preview.qiantucdn.com/weitu/79/12/80/43Z58PICGe3yQDKVMapgj_PIC2018.jpg!kuan320"
                data-src="https://preview.qiantucdn.com/weitu/52/74/06/91r58PICdHZiGe6EcTiNY_PIC2018.jpg!kuan320" alt="">
        </div>
    </div>
    <div class="box">
        <div class="pic">
            <img
                class="lazy"
                width="500" height="300"
                src="https://preview.qiantucdn.com/weitu/79/12/80/43Z58PICGe3yQDKVMapgj_PIC2018.jpg!kuan320"
                data-src="https://preview.qiantucdn.com/weitu/82/60/34/59458PICvTPMGbBX9U3py_PIC2018.jpg!kuan320" alt="">
        </div>
    </div>
    <div class="box">
        <div class="pic">
            <img
                class="lazy"
                width="500" height="200"
                src="https://preview.qiantucdn.com/weitu/79/12/80/43Z58PICGe3yQDKVMapgj_PIC2018.jpg!kuan320"
                data-src="https://preview.qiantucdn.com/weitu/52/74/06/91r58PICdHZiGe6EcTiNY_PIC2018.jpg!kuan320" alt="">
        </div>
    </div>
    <div class="box">
        <div class="pic">
            <img
                class="lazy"
                width="500" height="300"
                src="https://preview.qiantucdn.com/weitu/79/12/80/43Z58PICGe3yQDKVMapgj_PIC2018.jpg!kuan320"
                data-src="https://preview.qiantucdn.com/weitu/82/60/34/59458PICvTPMGbBX9U3py_PIC2018.jpg!kuan320" alt="">
        </div>
    </div>
    <div class="box">
        <div class="pic">
            <img
                class="lazy"
                width="500" height="200"
                src="https://preview.qiantucdn.com/weitu/79/12/80/43Z58PICGe3yQDKVMapgj_PIC2018.jpg!kuan320"
                data-src="https://preview.qiantucdn.com/weitu/52/74/06/91r58PICdHZiGe6EcTiNY_PIC2018.jpg!kuan320" alt="">
        </div>
    </div>
    <div class="box">
        <div class="pic">
            <img
                class="lazy"
                width="500" height="300"
                src="https://preview.qiantucdn.com/weitu/79/12/80/43Z58PICGe3yQDKVMapgj_PIC2018.jpg!kuan320"
                data-src="https://preview.qiantucdn.com/weitu/82/60/34/59458PICvTPMGbBX9U3py_PIC2018.jpg!kuan320" alt="">
        </div>
    </div>
    <div class="box">
        <div class="pic">
            <img
                class="lazy"
                width="500" height="200"
                src="https://preview.qiantucdn.com/weitu/79/12/80/43Z58PICGe3yQDKVMapgj_PIC2018.jpg!kuan320"
                data-src="https://preview.qiantucdn.com/weitu/52/74/06/91r58PICdHZiGe6EcTiNY_PIC2018.jpg!kuan320" alt="">
        </div>
    </div>
    <div class="box">
        <div class="pic">
            <img
                class="lazy"
                width="500" height="200"
                src="https://preview.qiantucdn.com/weitu/79/12/80/43Z58PICGe3yQDKVMapgj_PIC2018.jpg!kuan320"
                data-src="https://preview.qiantucdn.com/weitu/52/74/06/91r58PICdHZiGe6EcTiNY_PIC2018.jpg!kuan320" alt="">
        </div>
    </div>
    <div class="box">
        <div class="pic">
            <img
                class="lazy"
                width="500" height="300"
                src="https://preview.qiantucdn.com/weitu/79/12/80/43Z58PICGe3yQDKVMapgj_PIC2018.jpg!kuan320"
                data-src="https://preview.qiantucdn.com/weitu/82/60/34/59458PICvTPMGbBX9U3py_PIC2018.jpg!kuan320" alt="">
        </div>
    </div>
    <div class="box">
        <div class="pic">
            <img
                class="lazy"
                width="500" height="200"
                src="https://preview.qiantucdn.com/weitu/79/12/80/43Z58PICGe3yQDKVMapgj_PIC2018.jpg!kuan320"
                data-src="https://preview.qiantucdn.com/weitu/52/74/06/91r58PICdHZiGe6EcTiNY_PIC2018.jpg!kuan320" alt="">
        </div>
    </div>
    <div class="box">
        <div class="pic">
            <img
                class="lazy"
                width="500" height="200"
                src="https://preview.qiantucdn.com/weitu/79/12/80/43Z58PICGe3yQDKVMapgj_PIC2018.jpg!kuan320"
                data-src="https://preview.qiantucdn.com/weitu/52/74/06/91r58PICdHZiGe6EcTiNY_PIC2018.jpg!kuan320" alt="">
        </div>
    </div>
    <div class="box">
        <div class="pic">
            <img
                class="lazy"
                width="500" height="200"
                src="https://preview.qiantucdn.com/weitu/79/12/80/43Z58PICGe3yQDKVMapgj_PIC2018.jpg!kuan320"
                data-src="https://preview.qiantucdn.com/weitu/79/12/80/43Z58PICGe3yQDKVMapgj_PIC2018.jpg!kuan320" alt="">
        </div>
    </div>
    <div class="box">
        <div class="pic">
            <img
                class="lazy"
                width="500" height="500"
                src="https://preview.qiantucdn.com/weitu/79/12/80/43Z58PICGe3yQDKVMapgj_PIC2018.jpg!kuan320"
                data-src="https://preview.qiantucdn.com/weitu/82/60/34/59458PICvTPMGbBX9U3py_PIC2018.jpg!kuan320" alt="">
        </div>
    </div>
    <div class="box">
        <div class="pic">
            <img
                class="lazy"
                width="500" height="600"
                src="https://preview.qiantucdn.com/weitu/79/12/80/43Z58PICGe3yQDKVMapgj_PIC2018.jpg!kuan320"
                data-src="https://preview.qiantucdn.com/weitu/52/74/06/91r58PICdHZiGe6EcTiNY_PIC2018.jpg!kuan320" alt="">
        </div>
    </div>
    <div class="box">
        <div class="pic">
            <img
                class="lazy"
                width="500" height="300"
                src="https://preview.qiantucdn.com/weitu/79/12/80/43Z58PICGe3yQDKVMapgj_PIC2018.jpg!kuan320"
                data-src="https://preview.qiantucdn.com/weitu/82/60/34/59458PICvTPMGbBX9U3py_PIC2018.jpg!kuan320" alt="">
        </div>
    </div>
    <div class="box">
        <div class="pic">
            <img
                class="lazy"
                width="500" height="200"
                src="https://preview.qiantucdn.com/weitu/79/12/80/43Z58PICGe3yQDKVMapgj_PIC2018.jpg!kuan320"
                data-src="https://preview.qiantucdn.com/weitu/52/74/06/91r58PICdHZiGe6EcTiNY_PIC2018.jpg!kuan320" alt="">
        </div>
    </div>
    <div class="box">
        <div class="pic">
            <img
                class="lazy"
                width="500" height="300"
                src="https://preview.qiantucdn.com/weitu/79/12/80/43Z58PICGe3yQDKVMapgj_PIC2018.jpg!kuan320"
                data-src="https://preview.qiantucdn.com/weitu/82/60/34/59458PICvTPMGbBX9U3py_PIC2018.jpg!kuan320" alt="">
        </div>
    </div>
    <div class="box">
        <div class="pic">
            <img
                class="lazy"
                width="500" height="200"
                src="https://preview.qiantucdn.com/weitu/79/12/80/43Z58PICGe3yQDKVMapgj_PIC2018.jpg!kuan320"
                data-src="https://preview.qiantucdn.com/weitu/52/74/06/91r58PICdHZiGe6EcTiNY_PIC2018.jpg!kuan320" alt="">
        </div>
    </div>
    <div class="box">
        <div class="pic">
            <img
                class="lazy"
                width="500" height="300"
                src="https://preview.qiantucdn.com/weitu/79/12/80/43Z58PICGe3yQDKVMapgj_PIC2018.jpg!kuan320"
                data-src="https://preview.qiantucdn.com/weitu/82/60/34/59458PICvTPMGbBX9U3py_PIC2018.jpg!kuan320" alt="">
        </div>
    </div>
    <div class="box">
        <div class="pic">
            <img
                class="lazy"
                width="500" height="200"
                src="https://preview.qiantucdn.com/weitu/79/12/80/43Z58PICGe3yQDKVMapgj_PIC2018.jpg!kuan320"
                data-src="https://preview.qiantucdn.com/weitu/52/74/06/91r58PICdHZiGe6EcTiNY_PIC2018.jpg!kuan320" alt="">
        </div>
    </div>
    <div class="box">
        <div class="pic">
            <img
                class="lazy"
                width="500" height="200"
                src="https://preview.qiantucdn.com/weitu/79/12/80/43Z58PICGe3yQDKVMapgj_PIC2018.jpg!kuan320"
                data-src="https://preview.qiantucdn.com/weitu/52/74/06/91r58PICdHZiGe6EcTiNY_PIC2018.jpg!kuan320" alt="">
        </div>
    </div>
    <div class="box">
        <div class="pic">
            <img
                class="lazy"
                width="500" height="300"
                src="https://preview.qiantucdn.com/weitu/79/12/80/43Z58PICGe3yQDKVMapgj_PIC2018.jpg!kuan320"
                data-src="https://preview.qiantucdn.com/weitu/82/60/34/59458PICvTPMGbBX9U3py_PIC2018.jpg!kuan320" alt="">
        </div>
    </div>
    <div class="box">
        <div class="pic">
            <img
                class="lazy"
                width="500" height="200"
                src="https://preview.qiantucdn.com/weitu/79/12/80/43Z58PICGe3yQDKVMapgj_PIC2018.jpg!kuan320"
                data-src="https://preview.qiantucdn.com/weitu/52/74/06/91r58PICdHZiGe6EcTiNY_PIC2018.jpg!kuan320" alt="">
        </div>
    </div>
    <div class="box">
        <div class="pic">
            <img
                class="lazy"
                width="500" height="200"
                src="https://preview.qiantucdn.com/weitu/79/12/80/43Z58PICGe3yQDKVMapgj_PIC2018.jpg!kuan320"
                data-src="https://preview.qiantucdn.com/weitu/52/74/06/91r58PICdHZiGe6EcTiNY_PIC2018.jpg!kuan320" alt="">
        </div>
    </div>
</div>
</template>

<script>
import WaterFall from '../core/waterfall';
import lazyload from '../core/lazyload';
import { debounce } from '../utils';

export default {
  name: 'waterFall',
  mounted() {
      // 1. 瀑布流初始化
      //   let wf = new WaterFall();
      //   wf.init();

      // 2. 懒加载提高性能
      // 加载需要懒加载的图片
      let lazyImages = [].slice.call(document.querySelectorAll("img.lazy"));

      // 初始化懒加载
      lazyload(lazyImages);
      // 滚动页面时
      document.addEventListener("scroll", function() {
          lazyload(lazyImages);
      })
      
      // 3. 进一步优化，加入防抖 & 节流
      document.addEventListener("scroll", function() {
          debounce(lazyload(lazyImages));
      })

      // 4. 单例模式优化
      WaterFall.getInstance().init();
  }
}
</script>

<style scoped>
.cont {
    width: 1000px;
    height: 1500px;
    margin: 0 auto;
    position: relative;
}
.box {
    float: left;
    padding: 15px 0 0 15px;
}
.pic {
    padding: 15px;
    border:1px solid #ccc;
    border-radius: 10px;
    box-shadow: 0 0 5px #ccc;
}
.pic img {
    width:190px;
}
</style>
